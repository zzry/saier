<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>能源监控管理平台</title>
    <!-- <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"> -->
    <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
    <!-- <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
    <!-- <script src="javascripts/layer-v3.1.1/layer/layer.js"></script>
    <script src="javascripts/layui-v2.3.0/layui/layui.js"></script> -->
    <script src="javascripts/echarts.min.js"></script>
    <link href="javascripts/layui-v2.3.0/layui/css/layui.css" rel="stylesheet">

    <!--全局样式在这里-->
    <style>
        .header{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:5%;
            width:100%;
            height:12%;
            text-align: center;
            font-size:5.2em;
            color:#fff;
        }

        #buttonsmall{
            background-color: rgba(0,211,0,0.7);
            position:fixed;
            top:34%;
            left:12%;
            width:6%;
            height:12%;
            text-align: center;
            font-size:1.8em;
            color:#fff;
            border-radius:50%;
        }
        #buttonsmall2{
            background-color: rgba(222,22,11,0.7);
            position:fixed;
            top:49%;
            left:12%;
            width:6%;
            height:12%;
            text-align: center;
            font-size:1.8em;
            color:#fff;
            border-radius:50%;
        }
        .returntohome{
            background-color: rgba(0,0,0,0.7);
            position:fixed;
            top:40%;
            left:3%;
            width:8%;
            height:16%;
            text-align: center;
            font-size:1.8em;
            color:#fff;
            border-radius:50%;

        }

        .dataappear{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:25%;
            left:78%;
            width:20%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#00ffff;

        }
        #dataappear{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:25%;
            left:78%;
            width:20%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#00ffff;

        }
        .dataappearport{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:33%;
            left:78%;
            width:20%;
            height:6%;
            text-align: center;
            line-height:75px;
            font-size:1.5em;
            color:#00ffff;

        }
        #dataappearport{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:33%;
            left:78%;
            width:20%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#00ffff;

        }
        .dataappeardata1{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:41%;
            left:78%;
            width:10%;
            height:6%;
            text-align: center;
            line-height:75px;
            font-size:1.5em;
            color:#00ffff;

        }
        #dataappeardata1{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:41%;
            left:78%;
            width:10%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#00ffff;

        }
        .dataappeardata2{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:49%;
            left:78%;
            width:10%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#00ffff;

        }
        #dataappeardata2{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:49%;
            left:78%;
            width:10%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#00ffff;

        }
        .dataappeardata3{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:57%;
            left:78%;
            width:10%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#fff;

        }
        #dataappeardata3{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:57%;
            left:78%;
            width:10%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#fff;

        }
        .dataappeardata4{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:65%;
            left:78%;
            width:10%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#fff;

        }
        #dataappeardata4{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:65%;
            left:78%;
            width:10%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#fff;

        }
        .dataappeardata5{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:73%;
            left:78%;
            width:10%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#fff;

        }
        #dataappeardata5{
            background-color: rgba(0,0,0,0.5);
            position:fixed;
            top:73%;
            left:78%;
            width:10%;
            height:6%;
            text-align: center;
            line-height:60px;
            font-size:1.5em;
            color:#fff;

        }
        .dataappear-Screen{
            background-color: rgba(0,0,0,0.7);
            position:absolute;
            top:25%;
            left:21%;
            width:56%;
            height:65%;
            text-align: center;


        }
        .dataappear-NowTime{
            background-color: rgba(0,0,0,0.7);
            position:fixed;
            top:18%;
            left:35%;
            width:30%;
            height:6%;
            text-align: center;

        }
        #bigScreen-time{
            background-color: rgba(0,0,0,0.7);
            position:fixed;
            top:18%;
            left:35%;
            width:30%;
            height:6%;
            text-align: center;
            font-size:2.4em;
            color:#7FFFD4;

        }

        #greenLight{
          background-color: rgb(0,255,0);
          position:fixed;
          top:42%;
          left:73%;
          width:3%;
          height:6%;
          border-radius: 50%;
          /* opacity: 0.2; */
        }
        #greenLight_font{
          position:fixed;
          top:42.5%;
          left:69%;
          width:6%;
          height:6%;
          font-size:2em;
          color:rgb(0,255,0);
          /* opacity: 0.2; */
        }
        #yellowLight{
          background-color: rgb(255,150,0);
          position:fixed;
          top:52%;
          left:73%;
          width:3%;
          height:6%;
          border-radius: 50%;
          /* opacity: 0.2; */
        }
        #yellowLight_font{
          position:fixed;
          top:52.5%;
          left:69%;
          width:6%;
          height:6%;
          font-size:2em;
          color:rgb(255,150,0);
          /* opacity: 0.2; */
        }
        #redLight{
          background-color: rgb(255,0,0);
          position:fixed;
          top:62%;
          left:73%;
          width:3%;
          height:6%;
          border-radius: 50%;
          /* opacity: 0.2; */
        }
        #redLight_font{
          position:fixed;
          top:62.5%;
          left:69%;
          width:6%;
          height:6%;
          font-size:2em;
          color:rgb(255,0,0);
          /* opacity: 0.2; */
        }
    </style>
</head>

<body class="main" background="images/back.jpg" style="background-attachment: fixed; background-size:100% 100%;background-repeat:no-repeat">
<!--定义头部标题-->
<div>
    <p class="header">6LoWPAN能源监控管理平台</p>
</div>




    <form action="/start" method="post">
        <button id="buttonsmall">
            数据
        </button>
    </form>
    <form action="/drawbar" method="post">
        <button id="buttonsmall2">
            绘图
        </button>
    </form>
    <form action="/test" method="post">
        <button class="returntohome">
            返回首页
        </button>
    </form>
    <div class="dataappear-NowTime">
        <p id="bigScreen-time"> <p>
    </div>
    <div id="bigScreen"class="dataappear-Screen">

    </div>
    <div id="greenLight" style="opacity:0.2"> </div>
    <p id="greenLight_font" style="opacity:0.2">安全</p>
    <div id="yellowLight" style="opacity:0.2"> </div>
    <p id="yellowLight_font" style="opacity:0.2">警告</p>
    <div id="redLight" style="opacity:0.2"> </div>
    <p id="redLight_font" style="opacity:0.2">危险</p>

    <div id=" ">
        <input class="dataappeardata1" placeholder=" ">
        <p id="dataappeardata1"> </p>
        </input>
        <input class="dataappeardata2" placeholder=" ">
        <p id="dataappeardata2"> </p>
        </input>
        <input class="dataappearport" placeholder=" ">
        <p id="dataappearport"> </p>
        </input>
        <input class="dataappear" placeholder=" ">
        <p id="dataappear"> </p>
        </input>
        <input class="dataappeardata3" placeholder=" ">
        <p id="dataappeardata3"> </p>
        </input>
        <input class="dataappeardata4" placeholder=" ">
        <p id="dataappeardata4"> </p>
        </input>
        <input class="dataappeardata5" placeholder=" ">
        <p id="dataappeardata5"> </p>
        </input>
    </div>

</body>



<!-- 以下是调取数据库并显示文本的函数 -->
<script type="text/javascript">
    $("#buttonsmall").click(function() {

        $.ajax({
            url : "/users/start",
            dataType : "json",
            type : "post",
            async : true,
            success : function(data) {

                  var m=0;
                  setInterval(function(){
                    var objTime = document.getElementById("dataappear");
                    var objTem = document.getElementById("dataappeardata1");
                    var objHum = document.getElementById("dataappeardata2");
                    var objIP = document.getElementById("dataappearport");
                  if(m<data.listTime.length){

                              objTime.innerHTML= data.listTime[m];
                              objIP.innerHTML= data.listIP[m];
                              objTem.innerHTML= data.listTem[m]+"℃";
                              objHum.innerHTML= data.listHum[m]+"%";

                             m++;
                         }
                  if(m>=data.listTime.length){
                    objTime.innerHTML= "暂无数据更新";
                    objIP.innerHTML= "暂无数据更新";
                    objTem.innerHTML= "暂无数据更新";
                    objHum.innerHTML= "暂无数据更新";
                  }

                     }, 2000);

            },
            error: function(err) {
                alert(err);
            }
        });
            return false;
    })

</script>




<!-- 以下是使用echarts绘图的函数 -->
<script type="text/javascript">
    $("#buttonsmall2").click(function() {
var Timetest = [];
var Temtest = [];
var myChart = echarts.init(document.getElementById('bigScreen'));
var option = {
    tooltip : {
        formatter: "{a} <br/>{b} : {c}%"
    },
    toolbox: {
        feature: {
            restore: {},
            saveAsImage: {}
        }
    },
    series: [
        {
            name: '指标',
            type: 'gauge',
             min:0,
             max:40,
            detail: {formatter:'当前温度：{value}℃'},
            data: [{value:" "}],
        }
      ]
};



        $.ajax({
            url : "/draw/drawbar",
            dataType : "json",
            type : "post",
            async : true,
            success : function(data) {

              var m =0;
              var arrLight = data.listTem.map(Number);


               setInterval(function () {
                 if(m<data.listTem.length){
// 插入三灯警告的DOM操作
                   if(arrLight[m]<30)
                                      {
                                        document.getElementById('greenLight').style.opacity="0.7";
                                        document.getElementById('greenLight_font').style.opacity="0.7";
                                      }
                   if(arrLight[m]>=30&&arrLight[m]<38)
                                        {
                                        document.getElementById('yellowLight').style.opacity="0.7";
                                        document.getElementById('yellowLight_font').style.opacity="0.7";
                                        document.getElementById('greenLight').style.opacity="0.2";
                                        document.getElementById('greenLight_font').style.opacity="0.2";
                                      }
                    if(arrLight[m]>=38)
                                      {
                                        document.getElementById('yellowLight').style.opacity="0.2";
                                        document.getElementById('yellowLight_font').style.opacity="0.2";
                                        document.getElementById('greenLight').style.opacity="0.2";
                                        document.getElementById('greenLight_font').style.opacity="0.2";
                                        document.getElementById('redLight').style.opacity="0.7";
                                        document.getElementById('redLight_font').style.opacity="0.7";
                                       }

                    option.series[0].data[0].value = data.listTem[m];
                    myChart.setOption(option, true);
                    m++;
                  }
                  if(m>=data.listTem.length){
                    option.series[0].data[0].value = "XXX";
                    myChart.setOption(option, true);
                    m++;
                  }

                },2000);

             },

            error: function(err) {
                alert(err);
            }
        });
            return false;
    })

</script>


<!-- 以下是调取当前时间的函数 -->
<script type="text/javascript">
function displayTime(){
  var date = new Date();
  var getYear = date.getFullYear();
  var getMonth = date.getMonth()+1;
  if(getMonth<10){
    getMonth = "0"+getMonth;
  }
  var getDate= date.getDate();
  if(getDate<10){
    getDate = "0"+getDate;
  }
  var getHours= date.getHours();
  if(getHours<10){
    getHours = "0"+getHours;
  }
  var getMinutes= date.getMinutes();
  if(getMinutes<10){
    getMinutes = "0"+getMinutes;
  }
  var getSeconds= date.getSeconds();
  if(getSeconds<10){
    getSeconds = "0"+getSeconds;
  }
  var times = getYear+"-"+getMonth+"-"+getDate+"  "+getHours+":"+getMinutes+":"+getSeconds;
  $("#bigScreen-time").html("当前时间:"+times);
  setTimeout("displayTime()",1000);

}
  window.onload = function(){
  displayTime();
  };
</script>
</html>
